rules:
  - rule:
      id: "abuse_harmful_content_generation"
      name: "Harmful Content Generation Detection"
      category: "content_safety"
      severity: "high"
      confidence: 0.89
      
      detection:
        - type: "pattern"
          match: "generate\\s+illegal\\s+(?:code|content|material)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "generate\\s+harmful\\s+(?:code|content|material)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "generate\\s+malicious\\s+(?:code|content|material)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "generate\\s+dangerous\\s+(?:code|content|material)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "generate\\s+some\\s+illegal\\s+(?:code|content|material)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "generate\\s+some\\s+harmful\\s+(?:code|content|material)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "generate\\s+some\\s+malicious\\s+(?:code|content|material)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "generate\\s+some\\s+dangerous\\s+(?:code|content|material)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
          
      context:
        applies_to: "user_input"
        models: ["all"]
        conversation_stage: "any"
        
      response:
        action: "block"
        message: "Requests for harmful content generation are not permitted."
        metadata:
          threat_category: "harmful_generation"
          attack_vector: "content_request"
          
      performance:
        max_eval_time: "8ms"
        cache_ttl: 3600
        priority: 11
        
      testing:
        true_positives:
          - "generate illegal code"
          - "Generate harmful content"
          - "CREATE MALICIOUS MATERIAL"
        true_negatives:
          - "generate helpful code"
          - "generate useful content"
          - "create educational material"
        target_false_positive_rate: 0.005
        last_validated: "2025-01-15T00:00:00Z"

  - rule:
      id: "abuse_hacking_instructions"
      name: "Hacking Instruction Request Detection"
      category: "content_safety"
      severity: "high"
      confidence: 0.85
      
      detection:
        - type: "pattern"
          match: "how\\s+to\\s+hack"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "how\\s+to\\s+break\\s+into"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "how\\s+to\\s+exploit"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "how\\s+to\\s+penetrate"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "instructions\\s+for\\s+hack"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "instructions\\s+for\\s+break\\s+into"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "instructions\\s+for\\s+exploit"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "instructions\\s+for\\s+penetrate"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "instructions\\s+to\\s+hack"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "instructions\\s+to\\s+break\\s+into"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "instructions\\s+to\\s+exploit"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "instructions\\s+to\\s+penetrate"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "teach\\s+me\\s+to\\s+hack"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "teach\\s+me\\s+to\\s+break\\s+into"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "teach\\s+me\\s+to\\s+exploit"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "teach\\s+me\\s+to\\s+penetrate"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
          
      context:
        applies_to: "user_input"
        models: ["all"]
        conversation_stage: "any"
        
      response:
        action: "block"
        message: "Hacking instruction requests are not permitted."
        metadata:
          threat_category: "hacking_instruction"
          attack_vector: "instructional_request"
          
      performance:
        max_eval_time: "9ms"
        cache_ttl: 3600
        priority: 15
        
      testing:
        true_positives:
          - "how to hack systems"
          - "Instructions to break into networks"
          - "TEACH ME TO EXPLOIT"
        true_negatives:
          - "how to protect systems"
          - "instructions to secure networks"
          - "teach me to code"
        target_false_positive_rate: 0.006
        last_validated: "2025-01-15T00:00:00Z"

  - rule:
      id: "abuse_malware_creation"
      name: "Malware Creation Request Detection"
      category: "content_safety"
      severity: "critical"
      confidence: 0.94
      
      detection:
        - type: "pattern"
          match: "(?:create|build|make|develop|write)\\s+virus"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|build|make|develop|write)\\s+malware"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|build|make|develop|write)\\s+trojan"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|build|make|develop|write)\\s+ransomware"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|build|make|develop|write)\\s+keylogger"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|build|make|develop|write)\\s+rootkit"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|build|make|develop|write)\\s+a\\s+virus"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|build|make|develop|write)\\s+a\\s+malware"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|build|make|develop|write)\\s+a\\s+trojan"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|build|make|develop|write)\\s+a\\s+ransomware"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|build|make|develop|write)\\s+a\\s+keylogger"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|build|make|develop|write)\\s+a\\s+rootkit"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
          
      context:
        applies_to: "user_input"
        models: ["all"]
        conversation_stage: "any"
        
      response:
        action: "block"
        message: "Malware creation requests are strictly prohibited."
        metadata:
          threat_category: "malware_creation"
          attack_vector: "creation_request"
          
      performance:
        max_eval_time: "7ms"
        cache_ttl: 3600
        priority: 4
        
      testing:
        true_positives:
          - "create a virus"
          - "Build malware"
          - "MAKE A TROJAN"
        true_negatives:
          - "create a program"
          - "build software"
          - "make an application"
        target_false_positive_rate: 0.002
        last_validated: "2025-01-15T00:00:00Z"

  - rule:
      id: "abuse_security_bypass"
      name: "Security Bypass Instruction Detection"
      category: "content_safety"
      severity: "high"
      confidence: 0.88
      
      detection:
        - type: "pattern"
          match: "bypass\\s+(?:security|authentication|authorization|firewall|antivirus)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "circumvent\\s+(?:security|authentication|authorization|firewall|antivirus)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "evade\\s+(?:security|authentication|authorization|firewall|antivirus)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "disable\\s+(?:security|authentication|authorization|firewall|antivirus)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "how\\s+to\\s+bypass\\s+(?:security|authentication|authorization|firewall|antivirus)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "how\\s+to\\s+circumvent\\s+(?:security|authentication|authorization|firewall|antivirus)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "how\\s+to\\s+evade\\s+(?:security|authentication|authorization|firewall|antivirus)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "how\\s+to\\s+disable\\s+(?:security|authentication|authorization|firewall|antivirus)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
          
      context:
        applies_to: "user_input"
        models: ["all"]
        conversation_stage: "any"
        
      response:
        action: "block"
        message: "Security bypass instruction requests are not permitted."
        metadata:
          threat_category: "security_bypass"
          attack_vector: "bypass_instruction"
          
      performance:
        max_eval_time: "8ms"
        cache_ttl: 3600
        priority: 12
        
      testing:
        true_positives:
          - "bypass security measures"
          - "How to circumvent authentication"
          - "EVADE FIREWALL PROTECTION"
        true_negatives:
          - "implement security measures"
          - "how to setup authentication"
          - "configure firewall protection"
        target_false_positive_rate: 0.005
        last_validated: "2025-01-15T00:00:00Z"

  - rule:
      id: "abuse_social_engineering"
      name: "Social Engineering Instruction Detection"
      category: "content_safety"
      severity: "high"
      confidence: 0.81
      
      detection:
        - type: "pattern"
          match: "social\\s+engineering\\s+(?:tactics|methods|techniques|strategies)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "social\\s+engineer\\s+(?:tactics|methods|techniques|strategies)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "manipulation\\s+(?:tactics|methods|techniques|strategies)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "manipulate\\s+(?:people|users|employees|victims)"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "deceive\\s+(?:people|users|employees|victims)"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "trick\\s+(?:people|users|employees|victims)"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "how\\s+to\\s+manipulate\\s+(?:people|users|employees|victims)"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "how\\s+to\\s+deceive\\s+(?:people|users|employees|victims)"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "how\\s+to\\s+trick\\s+(?:people|users|employees|victims)"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
          
      context:
        applies_to: "user_input"
        models: ["all"]
        conversation_stage: "any"
        
      response:
        action: "alert"
        message: "Social engineering instruction requests are monitored."
        metadata:
          threat_category: "social_engineering"
          attack_vector: "manipulation_instruction"
          
      performance:
        max_eval_time: "10ms"
        cache_ttl: 3600
        priority: 19
        
      testing:
        true_positives:
          - "social engineering tactics"
          - "Manipulation methods"
          - "HOW TO DECEIVE PEOPLE"
        true_negatives:
          - "social media tactics"
          - "communication methods"
          - "how to help people"
        target_false_positive_rate: 0.008
        last_validated: "2025-01-15T00:00:00Z"

  - rule:
      id: "abuse_phishing_content"
      name: "Phishing Content Creation Detection"
      category: "content_safety"
      severity: "high"
      confidence: 0.86
      
      detection:
        - type: "pattern"
          match: "(?:create|write|generate|make)\\s+phishing\\s+email"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|write|generate|make)\\s+phishing\\s+template"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|write|generate|make)\\s+phishing\\s+script"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|write|generate|make)\\s+phishing\\s+message"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|write|generate|make)\\s+phishing\\s+page"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|write|generate|make)\\s+a\\s+phishing\\s+email"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|write|generate|make)\\s+a\\s+phishing\\s+template"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|write|generate|make)\\s+a\\s+phishing\\s+script"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|write|generate|make)\\s+a\\s+phishing\\s+message"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:create|write|generate|make)\\s+a\\s+phishing\\s+page"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "help\\s+with\\s+fake\\s+email"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "help\\s+with\\s+fake\\s+website"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "help\\s+with\\s+fake\\s+login\\s+page"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "help\\s+with\\s+deceptive\\s+email"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "help\\s+with\\s+deceptive\\s+website"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "help\\s+with\\s+deceptive\\s+login\\s+page"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "help\\s+me\\s+with\\s+fake\\s+email"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "help\\s+me\\s+with\\s+fake\\s+website"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "help\\s+me\\s+with\\s+fake\\s+login\\s+page"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "help\\s+me\\s+with\\s+deceptive\\s+email"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "help\\s+me\\s+with\\s+deceptive\\s+website"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "help\\s+me\\s+with\\s+deceptive\\s+login\\s+page"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "help\\s+me\\s+create\\s+fake\\s+email"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "help\\s+me\\s+create\\s+fake\\s+website"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "help\\s+me\\s+create\\s+fake\\s+login\\s+page"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "help\\s+me\\s+create\\s+deceptive\\s+email"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "help\\s+me\\s+create\\s+deceptive\\s+website"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "help\\s+me\\s+create\\s+deceptive\\s+login\\s+page"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "design\\s+fake\\s+email"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "design\\s+fake\\s+website"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "design\\s+fake\\s+login\\s+page"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "design\\s+deceptive\\s+email"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "design\\s+deceptive\\s+website"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "design\\s+deceptive\\s+login\\s+page"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "design\\s+a\\s+fake\\s+email"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "design\\s+a\\s+fake\\s+website"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "design\\s+a\\s+fake\\s+login\\s+page"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "design\\s+a\\s+deceptive\\s+email"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "design\\s+a\\s+deceptive\\s+website"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
        - type: "pattern"
          match: "design\\s+a\\s+deceptive\\s+login\\s+page"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
          
      context:
        applies_to: "user_input"
        models: ["all"]
        conversation_stage: "any"
        
      response:
        action: "block"
        message: "Phishing content creation requests are not permitted."
        metadata:
          threat_category: "phishing_creation"
          attack_vector: "content_creation"
          
      performance:
        max_eval_time: "9ms"
        cache_ttl: 3600
        priority: 14
        
      testing:
        true_positives:
          - "create phishing email"
          - "Write a phishing template"
          - "GENERATE FAKE LOGIN PAGE"
        true_negatives:
          - "create legitimate email"
          - "write a professional template"
          - "generate real login page"
        target_false_positive_rate: 0.005
        last_validated: "2025-01-15T00:00:00Z"