rules:
  - rule:
      id: "abuse_harmful_content_generation"
      name: "Harmful Content Generation Detection"
      category: "content_safety"
      severity: "high"
      confidence: 0.89
      
      detection:
        - type: "pattern"
          match: "generate\\s+(?:some\\s+)?(?:illegal|harmful|malicious|dangerous)\\s+(?:code|content|material)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
          
      context:
        applies_to: "user_input"
        models: ["all"]
        conversation_stage: "any"
        
      response:
        action: "block"
        message: "Requests for harmful content generation are not permitted."
        metadata:
          threat_category: "harmful_generation"
          attack_vector: "content_request"
          
      performance:
        max_eval_time: "8ms"
        cache_ttl: 3600
        priority: 11
        
      testing:
        true_positives:
          - "generate illegal code"
          - "Generate harmful content"
          - "CREATE MALICIOUS MATERIAL"
        true_negatives:
          - "generate helpful code"
          - "generate useful content"
          - "create educational material"
        target_false_positive_rate: 0.005
        last_validated: "2025-01-15T00:00:00Z"

  - rule:
      id: "abuse_hacking_instructions"
      name: "Hacking Instruction Request Detection"
      category: "content_safety"
      severity: "high"
      confidence: 0.85
      
      detection:
        - type: "pattern"
          match: "(?:how\\s+to|instructions\\s+(?:for|to)|teach\\s+me\\s+to)\\s+(?:hack|break\\s+into|exploit|penetrate)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
          
      context:
        applies_to: "user_input"
        models: ["all"]
        conversation_stage: "any"
        
      response:
        action: "block"
        message: "Hacking instruction requests are not permitted."
        metadata:
          threat_category: "hacking_instruction"
          attack_vector: "instructional_request"
          
      performance:
        max_eval_time: "9ms"
        cache_ttl: 3600
        priority: 15
        
      testing:
        true_positives:
          - "how to hack systems"
          - "Instructions to break into networks"
          - "TEACH ME TO EXPLOIT"
        true_negatives:
          - "how to protect systems"
          - "instructions to secure networks"
          - "teach me to code"
        target_false_positive_rate: 0.006
        last_validated: "2025-01-15T00:00:00Z"

  - rule:
      id: "abuse_malware_creation"
      name: "Malware Creation Request Detection"
      category: "content_safety"
      severity: "critical"
      confidence: 0.94
      
      detection:
        - type: "pattern"
          match: "(?:create|build|make|develop|write)\\s+(?:a\\s+)?(?:virus|malware|trojan|ransomware|keylogger|rootkit)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
          
      context:
        applies_to: "user_input"
        models: ["all"]
        conversation_stage: "any"
        
      response:
        action: "block"
        message: "Malware creation requests are strictly prohibited."
        metadata:
          threat_category: "malware_creation"
          attack_vector: "creation_request"
          
      performance:
        max_eval_time: "7ms"
        cache_ttl: 3600
        priority: 4
        
      testing:
        true_positives:
          - "create a virus"
          - "Build malware"
          - "MAKE A TROJAN"
        true_negatives:
          - "create a program"
          - "build software"
          - "make an application"
        target_false_positive_rate: 0.002
        last_validated: "2025-01-15T00:00:00Z"

  - rule:
      id: "abuse_security_bypass"
      name: "Security Bypass Instruction Detection"
      category: "content_safety"
      severity: "high"
      confidence: 0.88
      
      detection:
        - type: "pattern"
          match: "(?:how\\s+to\\s+)?(?:bypass|circumvent|evade|disable)\\s+(?:security|authentication|authorization|firewall|antivirus)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
          
      context:
        applies_to: "user_input"
        models: ["all"]
        conversation_stage: "any"
        
      response:
        action: "block"
        message: "Security bypass instruction requests are not permitted."
        metadata:
          threat_category: "security_bypass"
          attack_vector: "bypass_instruction"
          
      performance:
        max_eval_time: "8ms"
        cache_ttl: 3600
        priority: 12
        
      testing:
        true_positives:
          - "bypass security measures"
          - "How to circumvent authentication"
          - "EVADE FIREWALL PROTECTION"
        true_negatives:
          - "implement security measures"
          - "how to setup authentication"
          - "configure firewall protection"
        target_false_positive_rate: 0.005
        last_validated: "2025-01-15T00:00:00Z"

  - rule:
      id: "abuse_social_engineering"
      name: "Social Engineering Instruction Detection"
      category: "content_safety"
      severity: "high"
      confidence: 0.81
      
      detection:
        - type: "pattern"
          match: "(?:social\\s+engineer(?:ing)?|manipulation)\\s+(?:tactics|methods|techniques|strategies)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:how\\s+to\\s+)?(?:manipulate|deceive|trick)\\s+(?:people|users|employees|victims)"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
          
      context:
        applies_to: "user_input"
        models: ["all"]
        conversation_stage: "any"
        
      response:
        action: "alert"
        message: "Social engineering instruction requests are monitored."
        metadata:
          threat_category: "social_engineering"
          attack_vector: "manipulation_instruction"
          
      performance:
        max_eval_time: "10ms"
        cache_ttl: 3600
        priority: 19
        
      testing:
        true_positives:
          - "social engineering tactics"
          - "Manipulation methods"
          - "HOW TO DECEIVE PEOPLE"
        true_negatives:
          - "social media tactics"
          - "communication methods"
          - "how to help people"
        target_false_positive_rate: 0.008
        last_validated: "2025-01-15T00:00:00Z"

  - rule:
      id: "abuse_phishing_content"
      name: "Phishing Content Creation Detection"
      category: "content_safety"
      severity: "high"
      confidence: 0.86
      
      detection:
        - type: "pattern"
          match: "(?:create|write|generate|make)\\s+(?:a\\s+)?phishing\\s+(?:email|template|script|message|page)"
          flags: ["case_insensitive", "multiline"]
          weight: 1.0
        - type: "pattern"
          match: "(?:help\\s+(?:me\\s+)?(?:with|create)|design)\\s+(?:a\\s+)?(?:fake|deceptive)\\s+(?:email|website|login\\s+page)"
          flags: ["case_insensitive", "multiline"]
          weight: 0.9
          
      context:
        applies_to: "user_input"
        models: ["all"]
        conversation_stage: "any"
        
      response:
        action: "block"
        message: "Phishing content creation requests are not permitted."
        metadata:
          threat_category: "phishing_creation"
          attack_vector: "content_creation"
          
      performance:
        max_eval_time: "9ms"
        cache_ttl: 3600
        priority: 14
        
      testing:
        true_positives:
          - "create phishing email"
          - "Write a phishing template"
          - "GENERATE FAKE LOGIN PAGE"
        true_negatives:
          - "create legitimate email"
          - "write a professional template"
          - "generate real login page"
        target_false_positive_rate: 0.005
        last_validated: "2025-01-15T00:00:00Z"